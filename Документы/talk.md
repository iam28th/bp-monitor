Тема моей работы - прикроватный монитор пациента с возможностью диагностики иммобилизационного синдрома и контроля качества реабилитации

# Цель и задачи

Целью работы является разработка вышеназванного монитора.


Решаемые монитором задачи:
* измерение ЭКГ в 5 отведениях
* вычислеение ЧСС, определение аритмий и источника ритма
* отображение кривой ЭКГ, показателей ВСР, АД, сатурации, температуры тела
* контроль показателей - оповещение при выходе из заданного диапазона

Перечисленные выше функции свойственны любому монитору. Наш отличается наличием последней - __формирование индивидуальных рекомендаций о проведении реабилитационных мероприятий для пациентов с нарушением сознания__ посредством анализа ВСР и АД.


# Актуальность

Актуальность обусловлена тем, что реанимация и интенсивная терапия становится более распространённой и эффективной (см. относительное число койко-мест в ICU на слайде), опережая наши способности бороться долгосрочными последствиями пребывания в реанимации. Есть исследование, в котором показано, что расходы за 5 лет на медицинские услуги у выживших в реанимации возрастают в среднем в 1.5 раза.

Согласно Росстату, за 2016 год через отделения интенсивной терапии прошло порядка 80 тысяч человек, то есть речь идёт о достаточно внушительной сумме.

# Физиологическе основы ВСР

Вообще, что делает конкретно ВСР интересным объектом для изучения?

Временной ряд R-R можно рассматривать как некий универсальный ответ на совокупность внешних и внутренних раздражителей, поскольку на СР с разной частотой воздействует множество факторов: гуморальная и нервная система (СНС - увелич.), рефлекторные механизмы (например, хеморецепторы дуги аорты). Про это есть красивая картинка на слайде

Вообще, моя ВКР через руководителя связана с работой группы Дороговцева Виктора Николаевича в Федеральном научно-клиническом центре реаниматологии и реабилитологии. Они разрабатывают методы диагностики и терапии ИС на основе анализа показателей ВСР и АД. При этом решение для записи ЭКГ у них имеется, но для давления - нет,и смысл моей работы как раз в том, чтобы это такое решение предоставить.

# ВСР и АД

Одно из проявлений ИС - снижение чувствительности барорецепторов аорты, что может быть связано с общим снижением активности НС.
Это особенно ярко проявляется при вертикализации пациентов - то, что называется ортостатическая гипотомия - АД падает по сравнении с горизонтальным положением. Таким образом ортостатические нарушения гемодинамики можно обнаружать с помощью динамики АД.

Перейдём к следующему разделу
# Состав прибора

Разрабатываемое устройство является модульным, и его базовый состав следующий:
(состав с слайда)
При этом модульность системы допускает расширение функционала.

# Структурная схема
На слайде представлена структурная схема модуля АД.

Этот модуль состоит из манжеты, давление в которой устанавливается с помощью компрессора и ЭМ-клапана, которые управляются МК. В манжете есть абсолютный датчик давления, из выходного сигнала которого выделаются осцилляции, которые фильтруются, усиливаются и подаются в АЦП. Сам сигнал тоже оцифровывается.

В тексте работы приведены структурные схемы и принцип работы остальных модулей, которые сейчас я опущу в силу ограниченности времени.

# Разработка модуля НИАД

Когда я приступил к созданию схемы модуля АД в протеусе, то первой проблемой оказалось отсутствие возможности задать датчику произвольный выходной сигнал. Поэтому вместо датчика в модели использовался пользовательский блок из МК и ЦАПа. МК программно выдавал сигал давления в манжете из открытой базы данных.

На слайде приведена схема блкоа и выходной сигнал такого "датчика".

# Фильтр и усилитель

Из сигнала нужно выделить осцилляции - колебания давления в манжете. Это делается с помощью фильтра высоких частот 2-го порядка с частотой среза 0.5 Гц (частота взята из литературы). Далее сигнал нужно привести к рабочему диапазону АЦП - то есть поднять и усилить (примерно в 30 раз)

В качестве опорного напряжения АЦП атмеги используется внутренний источник в 2.56В.

На слайде показаны выделенные осцилляции, после того как они были приподняты и усилены.

# Электрическая схема

На этом слайде показана вся модель в протеусе. Помимо уже описанных узлов на ней есть делитель напряжения с повторителем для поднятия сигнала, конденсатор для уменьшения помех АЦП, кнопка и устройства вывода.

# Программирование МК

Пара слов о ПО МК. Оно состоит из 3 модулей - для работы с АЦП, картой и дисплеем - и основной программы.

Для АЦП важно выбрать тактовую частоту, потому что от неё зависит частота дискретезации. И как уже было сказано - внутренний источник опорного напряжения,  потом непрерывный режим работы, и разрешение прерываний.

Для SD-карты реализован интерфейс SPI для чтения и записи.

Для дислпея - набор функций для вывода результата.

Основной файл содержит функцию main с инициализацией переферии и вечным циклом, и обработчик прерываний от АЦП. В обработчике происходит переключение входов АЦП, поскольку одновременно нужно измерять давление в манжете и осцилляции.

# Алгоритмы для осциллометрического метода

Итак, у нас есть записи давления в манжете и осцилляции. Осталось непосредственно посчитать интересующие нас значения.

Вообще, что касается осциллометрического метода, консенсус достигнут только относительно среднего АД - оно соответствует тому моменту, когда амплитуда осцилляций максимальна.

Для определения СД и ДД используются различные эвристические алгоритмы.

Например, амплитудный. Его суть в том, что за СД принимают давление, когда амплитуда осцилляций равна половине от максимальной, за ДД - когда она равна 0.7-0.8 от максимальной (коэффициенты разняться в зависимости от источников).

Другой метод - наклона огибающей. Суть - выбрать моменты, когда производная огибающей максимальна по модулю. На восходящем участке в такой точке будет СД, на нисходящем - ДД.

Метод значимых осцилляций тоже основан на фиксированном значении амплитуд, только эти значения выбираются более хитрым образом.

И конечно же есть работы с применением машинного обучения, но в нашем случае этот вариант отпадает, потому что единственная открытая БД содержит всего 30 записей, что недостаточно для обучения.

Для реализации был выбран...

# Амплитудный алгоритм

Его можно разбить на 4 шага:
1. выделить пики
2. найти среди них максимум
3. по заданным отношениям посчитать амплитуды для СД и ДД
4. найти осцилляции с амплитудами, близкими к посчитанным

Результат выполнения алгоритма представлен на слайде.

# Валидация алгоритма

Для валидации алгоритма использовалась вышеупомянутая БД.  Из рассмотрения были удалены записи с нарушениями ритма (там было 3 с фибрилляцией предсердий) и ЧСС, лежащей вне нормального диапазона.

Диаграмма рассеяния для использованной выборки приведена на слайде. На ней кстати можно заметить интересный момент: связь между отношением СД к ДД и ЧСС - чем это отношение больше, тем ЧСС ниже. Не то чтобы это имело отношение к делу...

Также на слайде приведены метрики качества определения СД и ДД.
Значения коэффициентов подбирались по метрике МАЕ.

Видно, что алгоритм, несмотря на свою простоту и эвристическую природу, позволяет оценивать СД и ДД со средней абсолютной ошибкой меньше 5 мм рт.ст.

# Заключение

На этом у меня всё. Подводя итог, можно кратко перечислить результаты:

сделано ТЗ, структурная и электрическая схема, ПО для микроконтроллера. Реализован амплитудный алгоритм вычисления АД, и проведена его валидация на открытой базе данных.

Спасибо за внимание.
