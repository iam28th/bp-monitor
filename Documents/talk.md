Тема моей работы - прикроватный монитор пациента с возможностью диагностики иммобилизационного синдрома и контроля качества реабилитации

# Цель и задачи

Целью работы является разработка вышеназванного монитора.


Решаемые монитором задачи:
* измерение ЭКГ в 5 отведениях
* вычислеение ЧСС, определение аритмий и источника ритма
* отображение кривой ЭКГ, избранных физиологических показателей и
* их контроль - оповещение при выходе из заданного диапазона

Перечисленные выше функции свойственны любому монитору. Разрабатываемый же отличается наличием последней - __формирование индивидуальных рекомендаций о проведении реабилитационных мероприятий для пациентов с нарушением сознания__ посредством анализа ВСР и АД.

# Актуальность

Актуальность обусловлена тем, что реанимация и интенсивная терапия становится более распространённой и эффективной (вот например график изменения относительного числа койко-мест в ICU на слайде), опережая наши способности бороться с долгосрочными последствиями пребывания в реанимации. Есть исследование, в котором показано, что расходы за 5 лет на медицинские услуги у выживших в реанимации возрастают в среднем в 1.5 раза.

Согласно Росстату, за 2016 год через отделения интенсивной терапии прошло порядка 80 тысяч человек, то есть речь идёт о достаточно внушительной сумме.

# Физиологическе основы ВСР

Вообще, что делает конкретно ВСР интересным объектом для изучения?

Временной ряд продолжительности интервалов R-R можно рассматривать как некий универсальный ответ на совокупность внешних и внутренних раздражителей, поскольку на СР с разной частотой воздействует множество факторов: гуморальная и нервная система (СНС - увелич.), рефлекторные механизмы (например, хеморецепторы дуги аорты). Про это есть красивая картинка на слайде

Кроме того, сейчас ведётся разработка методов диагностики и терапии иммобилизационного синдрома на основе анализа показателей ВСР и АД. При этом, для записи ЭКГ имеются доступные готовые решения - например, модули Ардуино, но для давления готовых решений нет, и смысл моей работы в том, чтобы такое решение предоставить.

# ВСР и АД

Одно из проявлений ИС - снижение чувствительности барорецепторов аорты, что может быть связано с общим снижением активности НС.
Это особенно ярко проявляется при вертикализации пациентов - то, что называется ортостатическая гипотония - когда АД падает по сравнении с горизонтальным положением. Таким образом ортостатические нарушения гемодинамики можно обнаружать с помощью измерения АД.

Перейдём к следующему разделу.

# Состав прибора

Разрабатываемое устройство является модульным, его базовый состав приведён на слайде.
При этом модульность системы допускает расширение функционала.
Для всех представленных на слайде модулей в тексте ВКР описана структурная схема и принцип работы.
Более подробно проработан модуль неинвазивного артериального давления.

# Структурная схема
На этом слайде представлена его структурная схема.

Модуль состоит из манжеты, давление в которой устанавливается с помощью компрессора и ЭМ-клапана, которые управляются МК. В манжете есть абсолютный датчик давления, из выходного сигнала которого с помощью фильтра выделаются осцилляции, которые усиливаются и подаются в АЦП. Сам сигнал (т.е. уровень давления в манжете) тоже оцифровывается, что необходимо для реализации осциллометрического метода измерения АД.

# Разработка модуля НИАД

При создании схемы модуля АД в протеусе первой проблемой оказалось отсутствие возможности задать датчику произвольный выходной сигнал. Поэтому вместо датчика в модели использовался пользовательский блок из МК и ЦАПа. МК программно выдавал сигал давления в манжете из открытой базы данных.

На слайде приведена схема блкоа и выходной сигнал такого "датчика".

# Фильтр и усилитель

Из сигнала нужно выделить осцилляции - колебания давления в манжете. Это делается с помощью фильтра высоких частот 2-го порядка с частотой среза 0.5 Гц (частота взята из литературы). Далее сигнал нужно привести к рабочему диапазону АЦП - то есть поднять и усилить (примерно в 30 раз), что, соответственно, делается с помощью суммирующего усилителя.

# Осцилляции
АЦП используется встроенный от МК ATmega128, и для него можно выбрать внутренний источник опорного напряжения в 2.56В.
На слайде показаны выделенные осцилляции, после того как они были приподняты и усилены.

# Электрическая схема

На этом слайде показана вся модель в протеусе. Помимо уже описанных узлов на ней есть делитель напряжения с повторителем для поднятия сигнала, конденсатор для уменьшения помех АЦП, кнопка и устройства вывода.

# Программирование МК

Пара слов о ПО МК. Оно состоит из 3 модулей - для работы с АЦП, картой и дисплеем - и основной программы.

Для АЦП важно выбрать тактовую частоту, потому что от неё зависит частота дискретезации. Затем, как уже было сказано, внутренний источник опорного напряжения, потом непрерывный режим работы и разрешение прерываний.

Для SD-карты реализован интерфейс SPI для чтения и записи.

Для дисплея - набор функций для вывода результата.

Основной файл содержит функцию main с инициализацией переферии и вечным циклом, и обработчик прерываний от АЦП. В обработчике происходит переключение входов АЦП, поскольку одновременно нужно измерять давление в манжете и осцилляции.

# Алгоритмы для осциллометрического метода

Итак, у нас есть записи давления в манжете и записи осцилляции. Осталось непосредственно посчитать интересующие нас значения.

Тут стоит сказать, что при осциллометрическом методе консенсус достигнут только относительно среднего АД - оно соответствует тому моменту, когда амплитуда осцилляций максимальна.

Для определения СД и ДД используются различные эвристические алгоритмы.

Например, амплитудный. Его суть в том, что за СД принимают давление в момент, когда амплитуда осцилляций равна половине от максимальной, за ДД - когда она равна 0.7-0.8 от максимальной (причём коэффициенты разняться в зависимости от источников).

Другой метод - наклона огибающей. Суть - выбрать моменты, когда производная огибающей максимальна по модулю. На восходящем участке в такой точке будет СД, на нисходящем - ДД.

Метод значимых осцилляций тоже основан на фиксированном значении амплитуд, только эти значения выбираются более хитрым образом.

И конечно же есть работы с применением машинного обучения, но этот вариант отпадает, потому что единственная открытая БД содержит всего 30 записей, что для обучения явно недостаточно.

Для реализации был выбран амплитудный алгоритм. Давайте я на картинке со слайда покажу, в чём он заключается

# Амплитудный алгоритм

Его можно разбить на 4 шага:
1. выделить пики
2. найти среди них максимум
3. по заданным отношениям посчитать амплитуды для СД и ДД
4. найти осцилляции с амплитудами, близкими к посчитанным

Результат выполнения алгоритма представлен на слайде.

# Валидация алгоритма

Для валидации алгоритма использовалась вышеупомянутая БД.  Из рассмотрения были удалены записи с нарушениями ритма (там было 3 с фибрилляцией предсердий) и ЧСС, лежащей вне нормального диапазона.

Диаграмма рассеяния для использованной выборки приведена на слайде. На ней кстати можно заметить интересный момент: связь между отношением СД к ДД и ЧСС - чем это отношение больше, тем ЧСС ниже. Не то чтобы это имело отношение к делу, но тем не менее весьма занятно.

Также на слайде приведены метрики качества определения давления.
Значения коэффициентов подбирались по средней абсолютной ошибке.

Видно, что данный алгоритм, несмотря на свою простоту и эвристическую природу, позволяет оценивать СД и ДД со средней абсолютной ошибкой меньше 5 мм рт.ст.

# Заключение

На этом у меня всё. Подводя итог, можно кратко перечислить результаты:

Написано ТЗ, разработаны структурная и электрическая схема, ПО для микроконтроллера. Реализован амплитудный алгоритм вычисления АД для осциллометрического метода, и проведена его валидация на открытой базе данных.

Спасибо за внимание.
